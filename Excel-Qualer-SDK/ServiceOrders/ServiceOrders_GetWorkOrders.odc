<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/x-ms-odc; charset=utf-8">
<meta name=ProgId content=ODC.Database>
<meta name=SourceType content=OLEDB>
<title>ServiceOrders_GetWorkOrders</title>
<xml id=docprops><o:DocumentProperties
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns="http://www.w3.org/TR/REC-html40">
  <o:Description>Connection to the 'ServiceOrders_GetWorkOrders' query in the workbook.</o:Description>
  <o:Name>ServiceOrders_GetWorkOrders</o:Name>
 </o:DocumentProperties>
</xml><xml id=msodc><odc:OfficeDataConnection
  xmlns:odc="urn:schemas-microsoft-com:office:odc"
  xmlns="http://www.w3.org/TR/REC-html40">
  <odc:PowerQueryConnection odc:Type="OLEDB">
   <odc:ConnectionString>Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=ServiceOrders_GetWorkOrders;Extended Properties=&quot;&quot;</odc:ConnectionString>
   <odc:CommandType>SQL</odc:CommandType>
   <odc:CommandText>SELECT * FROM [ServiceOrders_GetWorkOrders]</odc:CommandText>
  </odc:PowerQueryConnection>
  <odc:PowerQueryMashupData>
    &lt;Mashup xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://schemas.microsoft.com/DataMashup&quot;&gt;&lt;Client&gt;EXCEL&lt;/Client&gt;&lt;Version&gt;2.140.405.0&lt;/Version&gt;&lt;MinVersion&gt;2.21.0.0&lt;/MinVersion&gt;&lt;Culture&gt;en-US&lt;/Culture&gt;&lt;SafeCombine&gt;true&lt;/SafeCombine&gt;&lt;Items&gt;&lt;Query Name=&quot;ServiceOrders_GetWorkOrders&quot;&gt;&lt;Formula&gt;&lt;![CDATA[let
    status = Excel.CurrentWorkbook(){[Name="status"]}[Content]{0},
    companyId = Excel.CurrentWorkbook(){[Name="companyId"]}[Content]{0},
    from = Excel.CurrentWorkbook(){[Name="from"]}[Content]{0},
    to = Excel.CurrentWorkbook(){[Name="to"]}[Content]{0},
    modifiedAfter = Excel.CurrentWorkbook(){[Name="modifiedAfter"]}[Content]{0},
    workOrderNumber = Excel.CurrentWorkbook(){[Name="workOrderNumber"]}[Content]{0},
    assignedEmployees = Excel.CurrentWorkbook(){[Name="assignedEmployees"]}[Content]{0},
    q1 = if Text.Length(status) > 0 then [ status = status ] else [],
    q2 = if Text.Length(companyId) > 0 then [ companyId = companyId ] else [],
    q3 = if Text.Length(from) > 0 then [ from = from ] else [],
    q4 = if Text.Length(to) > 0 then [ to = to ] else [],
    q5 = if Text.Length(modifiedAfter) > 0 then [ modifiedAfter = modifiedAfter ] else [],
    q6 = if Text.Length(workOrderNumber) > 0 then [ workOrderNumber = workOrderNumber ] else [],
    q7 = if Text.Length(assignedEmployees) > 0 then [ assignedEmployees = assignedEmployees ] else [],
    QueryOptions = Record.Combine({q1, q2, q3, q4, q5, q6, q7}),
    baseUrl = "https://jgiquality.qualer.com",
    relativeUrl = "api/service/workorders",
    response = Web.Contents(
        baseUrl,
        [
            RelativePath = Text.TrimStart(relativeUrl, "/"),
            Query = QueryOptions,
            Headers = [ Authorization = "Api-Token bf407589-f463-4046-ba2c-30642bd5d637" ]
        ]
    ),
    json = Json.Document(response),
    ConvertToTable = Table.FromList(json, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
    in ConvertToTable]]&gt;&lt;/Formula&gt;&lt;IsParameterQuery xsi:nil=&quot;true&quot; /&gt;&lt;IsDirectQuery xsi:nil=&quot;true&quot; /&gt;&lt;/Query&gt;&lt;/Items&gt;&lt;/Mashup&gt;
 </odc:PowerQueryMashupData>
 </odc:OfficeDataConnection>
</xml>

<style>
<!--
    .ODCDataSource
    {
    behavior: url(dataconn.htc);
    }
-->
</style>